---
import BaseLayout from './BaseLayout.astro';

interface Props {
  title: string;
  description: string;
  lastUpdated: Date | string;
  sources?: { name: string; url: string }[];
}

const { title, description, lastUpdated: rawDate, sources = [] } = Astro.props;

// Handle both Date objects and date strings
const lastUpdated = rawDate instanceof Date ? rawDate : new Date(rawDate);

const formattedDate = lastUpdated.toLocaleDateString('en-GB', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<BaseLayout title={`${title} | Data | PowerEurope`} description={description}>
  <div class="section">
    <div class="container-wide">
      <!-- Header -->
      <header class="mb-12 border-b border-ink-200 pb-8">
        <div class="flex items-center gap-3 mb-4">
          <span class="label">Data</span>
          <span class="text-ink-300">Â·</span>
          <span class="text-sm text-ink-500">
            Updated: {formattedDate}
          </span>
        </div>

        <h1 class="mb-6">{title}</h1>

        <p class="text-xl text-ink-600 max-w-2xl">
          {description}
        </p>
      </header>

      <!-- Main content slot -->
      <slot />

      <!-- Sources & methodology -->
      {sources.length > 0 && (
        <footer class="mt-16 pt-8 border-t border-ink-200">
          <p class="font-semibold mb-4">Data Sources</p>
          <ul class="space-y-2 text-sm text-ink-600">
            {sources.map((source) => (
              <li>
                <a href={source.url} class="underline underline-offset-2" target="_blank" rel="noopener">
                  {source.name}
                </a>
              </li>
            ))}
          </ul>
          <p class="mt-6 text-sm text-ink-500">
            All data available under <a href="https://creativecommons.org/licenses/by/4.0/" class="underline">CC BY 4.0</a>.
          </p>
        </footer>
      )}
    </div>
  </div>
</BaseLayout>
